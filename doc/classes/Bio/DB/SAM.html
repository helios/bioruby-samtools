<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Bio::DB::Sam</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Bio::DB::Sam</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/lib/bio/db/sam_rb.html">
                lib/bio/db/sam.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000024">average_coverage</a>&nbsp;&nbsp;
      <a href="#M000025">chromosome_coverage</a>&nbsp;&nbsp;
      <a href="#M000020">close</a>&nbsp;&nbsp;
      <a href="#M000032">deprecated_pileup</a>&nbsp;&nbsp;
      <a href="#M000028">fetch</a>&nbsp;&nbsp;
      <a href="#M000026">fetch_reference</a>&nbsp;&nbsp;
      <a href="#M000029">fetch_with_function</a>&nbsp;&nbsp;
      <a href="#M000021">finalize</a>&nbsp;&nbsp;
      <a href="#M000022">load_index</a>&nbsp;&nbsp;
      <a href="#M000023">load_reference</a>&nbsp;&nbsp;
      <a href="#M000030">merge</a>&nbsp;&nbsp;
      <a href="#M000031">mpileup</a>&nbsp;&nbsp;
      <a href="#M000017">new</a>&nbsp;&nbsp;
      <a href="#M000018">open</a>&nbsp;&nbsp;
      <a href="#M000027">query_string</a>&nbsp;&nbsp;
      <a href="#M000019">to_s</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">sam_file</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000021" class="method-detail">
        <a name="M000021"></a>

        <div class="method-heading">
          <a href="Sam.src/M000021.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000021.html');return false;">
          <span class="method-name">finalize</span><span class="method-args">(id)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Destructor method that closes the file before letting the object be garbage
collected.
</p>
        </div>
      </div>

      <div id="method-M000030" class="method-detail">
        <a name="M000030"></a>

        <div class="method-heading">
          <a href="Sam.src/M000030.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000030.html');return false;">
          <span class="method-name">merge</span><span class="method-args">(files, merged_file, headers, add_RG, by_qname)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Merges n BAM files. This doesn&#8216;t require to create a <a
href="SAM.html">SAM</a> object
</p>
<table>
<tr><td valign="top">files:</td><td>An array with the paths to the files.

</td></tr>
<tr><td valign="top">merged_file:</td><td>The path to the merged file

</td></tr>
<tr><td valign="top">headers:</td><td>The BAM file containing the header

</td></tr>
<tr><td valign="top">add_RG:</td><td>If true, the RG tag is added (infered from the filenames)

</td></tr>
<tr><td valign="top">by_qname:</td><td>If true, the bamfiles should by ordered by query name, if false, by
coordinates.

</td></tr>
</table>
        </div>
      </div>

      <div id="method-M000017" class="method-detail">
        <a name="M000017"></a>

        <div class="method-heading">
          <a href="Sam.src/M000017.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000017.html');return false;">
          <span class="method-name">new</span><span class="method-args">(optsa={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
To make a <a href="Sam.html#M000017">new</a> sam object. Initialize expects
a hash optsa with the following elemets:
</p>
<table>
<tr><td valign="top">fasta:</td><td>The fasta file with the reference. (nil)

</td></tr>
<tr><td valign="top">bam:</td><td>path to a binary <a href="SAM.html">SAM</a> file (nil)

</td></tr>
<tr><td valign="top">tam:</td><td>path to a text <a href="SAM.html">SAM</a> file (nil)

</td></tr>
<tr><td valign="top">compressed:</td><td>If the binary file is compressed (true)

</td></tr>
<tr><td valign="top">write:</td><td>If the file is to be writen (false). Not supported yet.

</td></tr>
</table>
<p>
*NOTE:* you can&#8216;t use binary and text formats simultaneusly. To make
queries, the file has to be a sorted binary. This function doesn&#8216;t
actually <a href="Sam.html#M000018">open</a> the file, it just prepares the
object to be opened in a later stage.
</p>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000024" class="method-detail">
        <a name="M000024"></a>

        <div class="method-heading">
          <a href="Sam.src/M000024.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000024.html');return false;">
          <span class="method-name">average_coverage</span><span class="method-args">(chromosome, qstart, len)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the average coverage of a region in a bam file.
</p>
        </div>
      </div>

      <div id="method-M000025" class="method-detail">
        <a name="M000025"></a>

        <div class="method-heading">
          <a href="Sam.src/M000025.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000025.html');return false;">
          <span class="method-name">chromosome_coverage</span><span class="method-args">(chromosome, qstart, len)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an array with the coverage at each possition in the queried region
This is a simple average coverage just calculated with the first and last
possition of the alignment, ignoring the gaps.
</p>
        </div>
      </div>

      <div id="method-M000020" class="method-detail">
        <a name="M000020"></a>

        <div class="method-heading">
          <a href="Sam.src/M000020.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000020.html');return false;">
          <span class="method-name">close</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Closes the sam file and destroys the C pointers using the functions
provided by libbam
</p>
        </div>
      </div>

      <div id="method-M000032" class="method-detail">
        <a name="M000032"></a>

        <div class="method-heading">
          <a href="Sam.src/M000032.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000032.html');return false;">
          <span class="method-name">deprecated_pileup</span><span class="method-args">( cmd ) {|Pileup.new(line)| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
utility method that does not use the samtools API, it calls samtools
directly as if on the command line and catches the output, to use this
method you must have a version of samtools that supports the pileup command
(&lt; 0.1.17) otherwise the command will fail. <a
href="Sam.html#M000031">mpileup</a> is the preferred method for getting
pileups. With this method the sam object should be created as usual, but
you need to pass this method a string of options for samtools you
don&#8216;t need to provide the call to samtools pileup itself or -f
&lt;fasta file&gt; or the bam file itself, these are taken from the sam
object
</p>
        </div>
      </div>

      <div id="method-M000028" class="method-detail">
        <a name="M000028"></a>

        <div class="method-heading">
          <a href="Sam.src/M000028.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000028.html');return false;">
          <span class="method-name">fetch</span><span class="method-args">(chromosome, qstart, qend)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an array of Alignments on a given region.
</p>
        </div>
      </div>

      <div id="method-M000026" class="method-detail">
        <a name="M000026"></a>

        <div class="method-heading">
          <a href="Sam.src/M000026.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000026.html');return false;">
          <span class="method-name">fetch_reference</span><span class="method-args">(chromosome, qstart,qend)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the sequence for a given region.
</p>
        </div>
      </div>

      <div id="method-M000029" class="method-detail">
        <a name="M000029"></a>

        <div class="method-heading">
          <a href="Sam.src/M000029.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000029.html');return false;">
          <span class="method-name">fetch_with_function</span><span class="method-args">(chromosome, qstart, qend, function)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Executes a function on each <a href="Alignment.html">Alignment</a> inside
the queried region of the chromosome. The chromosome can be either the
textual name or a FixNum with the internal index. However, you need to get
the internal index with the provided API, otherwise the pointer is outside
the scope of the C library. Returns the count of alignments in the region.
WARNING: Accepts an index already parsed by the library. It fails when you
use your own FixNum (FFI-bug?)
</p>
        </div>
      </div>

      <div id="method-M000022" class="method-detail">
        <a name="M000022"></a>

        <div class="method-heading">
          <a href="Sam.src/M000022.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000022.html');return false;">
          <span class="method-name">load_index</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Loads the bam index to be used for fetching. If the index doesn&#8216;t
exists the index is built provided that the user has writing access to the
folder where the BAM file is located. If the creation of the file fails a
<a href="SAMException.html">SAMException</a> is thrown. If the index
doesn&#8216;t exist, loading it will take more time. It is suggested to
generate the index separatedly if the bam file sits on a server where the
executing user may not have writing permissions in the server.
</p>
        </div>
      </div>

      <div id="method-M000023" class="method-detail">
        <a name="M000023"></a>

        <div class="method-heading">
          <a href="Sam.src/M000023.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000023.html');return false;">
          <span class="method-name">load_reference</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Loads the reference file to be able to query regions of it. This requires
the fai index to exist in the same folder than the reference. If it
doesn&#8216;t exisits, this functions attempts to generate it. If user
doesn&#8216;t have writing permissions on the folder, or the creation of
the fai fails for any reason, a <a
href="SAMException.html">SAMException</a> is thrown.
</p>
        </div>
      </div>

      <div id="method-M000031" class="method-detail">
        <a name="M000031"></a>

        <div class="method-heading">
          <a href="Sam.src/M000031.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000031.html');return false;">
          <span class="method-name">mpileup</span><span class="method-args">( opts ) {|Pileup.new(line)| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
calls the <a href="Sam.html#M000031">mpileup</a> function, opts is a hash
of options identical to the command line options for <a
href="Sam.html#M000031">mpileup</a>. is an iterator that yields a <a
href="../../Pileup.html">Pileup</a> object for each postion the command
line options that generate/affect BCF/VCF are ignored ie (g,u,e,h,I,L,o,p)
call the option as a symbol of the flag, eg -r for region is called :r
=&gt; &quot;some <a href="SAM.html">SAM</a> compatible region&quot; eg
bam.mpileup(:r =&gt; &quot;chr1:1000-2000&quot;, :q =&gt; 50) gets the
bases with quality &gt; 50 on chr1 between 1000-5000
</p>
        </div>
      </div>

      <div id="method-M000018" class="method-detail">
        <a name="M000018"></a>

        <div class="method-heading">
          <a href="Sam.src/M000018.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000018.html');return false;">
          <span class="method-name">open</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Function that actually opens the sam file Throws a <a
href="SAMException.html">SAMException</a> if the file can&#8216;t be <a
href="Sam.html#M000018">open</a>.
</p>
        </div>
      </div>

      <div id="method-M000027" class="method-detail">
        <a name="M000027"></a>

        <div class="method-heading">
          <a href="Sam.src/M000027.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000027.html');return false;">
          <span class="method-name">query_string</span><span class="method-args">(chromosome, qstart,qend)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Generates a query sting to be used by the region parser in samtools. In
principle, you shouldn&#8216;t need to use this function.
</p>
        </div>
      </div>

      <div id="method-M000019" class="method-detail">
        <a name="M000019"></a>

        <div class="method-heading">
          <a href="Sam.src/M000019.html" target="Code" class="method-signature"
            onclick="popupCode('Sam.src/M000019.html');return false;">
          <span class="method-name">to_s</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Prints a description of the sam file in a text format containg if it is
binary or text, the path and the fasta file of the reference
</p>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>